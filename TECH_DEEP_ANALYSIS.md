# TradingAgents-CN é¡¹ç›®æŠ€æœ¯æ·±åº¦è§£æä¸ä¸Šæ‰‹æŒ‡å—

## ç›®å½•
1. [é¡¹ç›®æ¦‚è¿°](#1-é¡¹ç›®æ¦‚è¿°)
2. [ç³»ç»Ÿæ¶æ„è®¾è®¡](#2-ç³»ç»Ÿæ¶æ„è®¾è®¡)
3. [æ ¸å¿ƒæŠ€æœ¯æ ˆè§£æ](#3-æ ¸å¿ƒæŠ€æœ¯æ ˆè§£æ)
4. [å…³é”®ä»£ç æ·±åº¦è§£æ](#4-å…³é”®ä»£ç æ·±åº¦è§£æ)
5. [æœ¬åœ°ç¯å¢ƒè®¾ç½®ä¸å¯åŠ¨æŒ‡å—](#5-æœ¬åœ°ç¯å¢ƒè®¾ç½®ä¸å¯åŠ¨æŒ‡å—)

---

## 1. é¡¹ç›®æ¦‚è¿°

### æ ¸å¿ƒä¸šåŠ¡ä»·å€¼

TradingAgents-CN æ˜¯ä¸€ä¸ªä¸“ä¸ºä¸­å›½é‡‘èå¸‚åœºè®¾è®¡çš„å¤šæ™ºèƒ½ä½“AIäº¤æ˜“åˆ†ææ¡†æ¶ã€‚è¯¥é¡¹ç›®æ—¨åœ¨é€šè¿‡å¤šä¸ªä¸“ä¸šçš„AIåˆ†æå¸ˆåä½œï¼Œä¸ºæŠ•èµ„è€…æä¾›å…¨é¢ã€æ·±å…¥çš„è‚¡ç¥¨æŠ•èµ„åˆ†æå’Œå»ºè®®ã€‚

**æ ¸å¿ƒè§£å†³çš„é—®é¢˜ï¼š**
- **ä¿¡æ¯è¿‡è½½é—®é¢˜**ï¼šæ•´åˆæ¥è‡ªå¤šä¸ªæ•°æ®æºçš„æµ·é‡é‡‘èä¿¡æ¯ï¼Œé€šè¿‡AIè¿›è¡Œæ™ºèƒ½ç­›é€‰å’Œåˆ†æ
- **åˆ†æåè§é—®é¢˜**ï¼šé€šè¿‡å¤šæ™ºèƒ½ä½“è¾©è®ºæœºåˆ¶ï¼Œå‡å°‘å•ä¸€è§†è§’å¸¦æ¥çš„åˆ†æåè§
- **å®æ—¶æ€§é—®é¢˜**ï¼šæä¾›è¿‘å®æ—¶çš„å¸‚åœºåˆ†æå’ŒæŠ•èµ„å»ºè®®
- **æœ¬åœŸåŒ–é—®é¢˜**ï¼šä¸“é—¨é’ˆå¯¹Aè‚¡ã€æ¸¯è‚¡å¸‚åœºç‰¹ç‚¹è¿›è¡Œä¼˜åŒ–ï¼Œæ”¯æŒä¸­æ–‡é‡‘èæ•°æ®å¤„ç†

**ç›®æ ‡ç”¨æˆ·ï¼š**
- ä¸ªäººæŠ•èµ„è€…ï¼šéœ€è¦ä¸“ä¸šåˆ†æä½†ç¼ºä¹æ—¶é—´æˆ–ä¸“ä¸šçŸ¥è¯†
- é‡‘èåˆ†æå¸ˆï¼šéœ€è¦è¾…åŠ©å·¥å…·æé«˜åˆ†ææ•ˆç‡
- é‡åŒ–äº¤æ˜“å›¢é˜Ÿï¼šéœ€è¦ç»“æ„åŒ–çš„å¸‚åœºæ´å¯Ÿ
- é‡‘èç§‘æŠ€å…¬å¸ï¼šéœ€è¦é›†æˆæ™ºèƒ½åˆ†æèƒ½åŠ›

### åŠŸèƒ½æ¨¡å—åˆ’åˆ†

1. **å¤šæ™ºèƒ½ä½“åˆ†æç³»ç»Ÿ**
   - å¸‚åœºåˆ†æå¸ˆï¼šæŠ€æœ¯åˆ†æå’Œè¶‹åŠ¿é¢„æµ‹
   - åŸºæœ¬é¢åˆ†æå¸ˆï¼šè´¢åŠ¡æ•°æ®åˆ†æå’Œä¼°å€¼è¯„ä¼°
   - æ–°é—»åˆ†æå¸ˆï¼šå®æ—¶æ–°é—»æƒ…ç»ªåˆ†æ
   - ç¤¾äº¤åª’ä½“åˆ†æå¸ˆï¼šç¤¾äº¤å¹³å°æƒ…ç»ªç›‘æ§

2. **ç ”ç©¶è¾©è®ºæœºåˆ¶**
   - å¤šæ–¹ç ”ç©¶å‘˜ï¼šä»ä¸åŒè§’åº¦è¿›è¡Œæ·±åº¦ç ”ç©¶
   - è¾©è®ºç³»ç»Ÿï¼šé€šè¿‡å¯¹ç«‹è§‚ç‚¹æé«˜åˆ†æè´¨é‡
   - é£é™©è¯„ä¼°ï¼šå¤šç»´åº¦é£é™©åˆ†æå’Œæ§åˆ¶

3. **æ•°æ®èåˆå¹³å°**
   - å¤šæ•°æ®æºé›†æˆï¼šTushareã€AkShareã€FinnHubç­‰
   - æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿï¼šå¤šå±‚ç¼“å­˜ä¼˜åŒ–æ•°æ®è®¿é—®
   - å®æ—¶æ•°æ®å¤„ç†ï¼šæ”¯æŒå®æ—¶å’Œå†å²æ•°æ®åˆ†æ

4. **ç”¨æˆ·äº¤äº’ç•Œé¢**
   - Webç•Œé¢ï¼šåŸºäºStreamlitçš„ç›´è§‚æ“ä½œç•Œé¢
   - CLIç•Œé¢ï¼šå‘½ä»¤è¡Œå·¥å…·æ”¯æŒæ‰¹é‡å¤„ç†
   - APIæ¥å£ï¼šæ”¯æŒç¨‹åºåŒ–è°ƒç”¨å’Œé›†æˆ

---

## 2. ç³»ç»Ÿæ¶æ„è®¾è®¡

### æ¶æ„å›¾æè¿°

```mermaid
graph TB
    subgraph "ç”¨æˆ·ç•Œé¢å±‚"
        A[Webç•Œé¢<br/>Streamlit] 
        B[CLIç•Œé¢<br/>å‘½ä»¤è¡Œå·¥å…·]
        C[APIæ¥å£<br/>REST API]
    end
    
    subgraph "æ ¸å¿ƒç¼–æ’å±‚"
        D[TradingGraph<br/>LangGraphç¼–æ’å¼•æ“]
        E[ä¿¡å·å¤„ç†å™¨<br/>SignalProcessor]
        F[æ¡ä»¶é€»è¾‘<br/>ConditionalLogic]
    end
    
    subgraph "æ™ºèƒ½ä½“å±‚"
        G[å¸‚åœºåˆ†æå¸ˆ<br/>MarketAnalyst]
        H[åŸºæœ¬é¢åˆ†æå¸ˆ<br/>FundamentalsAnalyst]
        I[æ–°é—»åˆ†æå¸ˆ<br/>NewsAnalyst]
        J[ç¤¾äº¤åˆ†æå¸ˆ<br/>SocialAnalyst]
        K[å¤šæ–¹ç ”ç©¶å‘˜<br/>Researchers]
        L[é£é™©ç®¡ç†<br/>RiskManager]
        M[äº¤æ˜“å†³ç­–<br/>Trader]
    end
    
    subgraph "LLMé€‚é…å±‚"
        N[DashScope<br/>é˜¿é‡Œäº‘Qwen]
        O[DeepSeek<br/>æ·±åº¦æ±‚ç´¢]
        P[OpenAI<br/>GPTç³»åˆ—]
        Q[Google AI<br/>Gemini]
    end
    
    subgraph "æ•°æ®è®¿é—®å±‚"
        R[Tushare<br/>ä¸“ä¸šé‡‘èæ•°æ®]
        S[AkShare<br/>å¼€æºæ•°æ®]
        T[FinnHub<br/>å›½é™…å¸‚åœº]
        U[Yahoo Finance<br/>å…¨çƒè‚¡å¸‚]
        V[å®æ—¶æ–°é—»<br/>News APIs]
    end
    
    subgraph "å­˜å‚¨å±‚"
        W[MongoDB<br/>æ–‡æ¡£å­˜å‚¨]
        X[Redis<br/>ç¼“å­˜ç³»ç»Ÿ]
        Y[ChromaDB<br/>å‘é‡å­˜å‚¨]
        Z[æ–‡ä»¶ç¼“å­˜<br/>æœ¬åœ°å­˜å‚¨]
    end
    
    A --> D
    B --> D
    C --> D
    
    D --> G
    D --> H
    D --> I
    D --> J
    D --> K
    D --> L
    D --> M
    
    G --> N
    H --> O
    I --> P
    J --> Q
    
    G --> R
    H --> S
    I --> T
    J --> U
    K --> V
    
    N --> W
    O --> X
    P --> Y
    Q --> Z
```

### ç›®å½•ç»“æ„è§£è¯»

```
TradingAgents-CN/
â”œâ”€â”€ tradingagents/                    # æ ¸å¿ƒæ¡†æ¶ä»£ç 
â”‚   â”œâ”€â”€ agents/                       # æ™ºèƒ½ä½“å®ç°
â”‚   â”‚   â”œâ”€â”€ analysts/                 # å„ç±»åˆ†æå¸ˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ market_analyst.py     # å¸‚åœºåˆ†æå¸ˆï¼šæŠ€æœ¯åˆ†æå’Œè¶‹åŠ¿é¢„æµ‹
â”‚   â”‚   â”‚   â”œâ”€â”€ fundamentals_analyst.py # åŸºæœ¬é¢åˆ†æå¸ˆï¼šè´¢åŠ¡æ•°æ®åˆ†æ
â”‚   â”‚   â”‚   â”œâ”€â”€ news_analyst.py       # æ–°é—»åˆ†æå¸ˆï¼šæ–°é—»æƒ…ç»ªåˆ†æ
â”‚   â”‚   â”‚   â””â”€â”€ social_media_analyst.py # ç¤¾äº¤åª’ä½“åˆ†æå¸ˆ
â”‚   â”‚   â”œâ”€â”€ managers/                 # ç®¡ç†å±‚æ™ºèƒ½ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ research_manager.py   # ç ”ç©¶ç®¡ç†å™¨ï¼šåè°ƒç ”ç©¶æµç¨‹
â”‚   â”‚   â”‚   â””â”€â”€ risk_manager.py       # é£é™©ç®¡ç†å™¨ï¼šé£é™©è¯„ä¼°å’Œæ§åˆ¶
â”‚   â”‚   â”œâ”€â”€ researchers/              # ç ”ç©¶å‘˜æ™ºèƒ½ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ bull_researcher.py    # å¤šæ–¹ç ”ç©¶å‘˜ï¼šçœ‹æ¶¨è§‚ç‚¹
â”‚   â”‚   â”‚   â””â”€â”€ bear_researcher.py    # ç©ºæ–¹ç ”ç©¶å‘˜ï¼šçœ‹è·Œè§‚ç‚¹
â”‚   â”‚   â””â”€â”€ trader/                   # äº¤æ˜“å†³ç­–è€…
â”‚   â”‚       â””â”€â”€ trader.py             # æœ€ç»ˆäº¤æ˜“å†³ç­–æ™ºèƒ½ä½“
â”‚   â”œâ”€â”€ graph/                        # å›¾ç¼–æ’ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ trading_graph.py          # ä¸»è¦ç¼–æ’ç±»ï¼šåè°ƒæ‰€æœ‰æ™ºèƒ½ä½“
â”‚   â”‚   â”œâ”€â”€ conditional_logic.py      # æ¡ä»¶é€»è¾‘ï¼šåŠ¨æ€è·¯ç”±å†³ç­–
â”‚   â”‚   â”œâ”€â”€ signal_processing.py      # ä¿¡å·å¤„ç†ï¼šæ™ºèƒ½ä½“é—´é€šä¿¡
â”‚   â”‚   â””â”€â”€ propagation.py            # ä¿¡æ¯ä¼ æ’­ï¼šçŠ¶æ€æ›´æ–°æœºåˆ¶
â”‚   â”œâ”€â”€ dataflows/                    # æ•°æ®æµå¤„ç†
â”‚   â”‚   â”œâ”€â”€ interface.py              # ç»Ÿä¸€æ•°æ®æ¥å£ï¼šæ‰€æœ‰æ•°æ®æºçš„ç»Ÿä¸€å…¥å£
â”‚   â”‚   â”œâ”€â”€ tushare_utils.py          # Tushareæ•°æ®é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ akshare_utils.py          # AkShareæ•°æ®é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ finnhub_utils.py          # FinnHubæ•°æ®é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ cache_manager.py          # ç¼“å­˜ç®¡ç†ï¼šå¤šå±‚ç¼“å­˜ç­–ç•¥
â”‚   â”‚   â””â”€â”€ data_source_manager.py    # æ•°æ®æºç®¡ç†ï¼šæ™ºèƒ½åˆ‡æ¢å’Œå®¹é”™
â”‚   â”œâ”€â”€ llm_adapters/                 # LLMé€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ dashscope_adapter.py      # é˜¿é‡Œäº‘DashScopeé€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ deepseek_adapter.py       # DeepSeeké€‚é…å™¨
â”‚   â”‚   â””â”€â”€ openai_compatible_base.py # OpenAIå…¼å®¹åŸºç±»
â”‚   â”œâ”€â”€ config/                       # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ config_manager.py         # é…ç½®ç®¡ç†å™¨ï¼šç»Ÿä¸€é…ç½®å¤„ç†
â”‚   â”‚   â””â”€â”€ database_config.py        # æ•°æ®åº“é…ç½®ï¼šMongoDB/Redisè®¾ç½®
â”‚   â””â”€â”€ utils/                        # å·¥å…·æ¨¡å—
â”‚       â”œâ”€â”€ logging_manager.py        # æ—¥å¿—ç®¡ç†ï¼šç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿ
â”‚       â””â”€â”€ stock_utils.py            # è‚¡ç¥¨å·¥å…·ï¼šä»£ç éªŒè¯ç­‰
â”œâ”€â”€ web/                              # Webç•Œé¢
â”‚   â”œâ”€â”€ app.py                        # Streamlitä¸»åº”ç”¨ï¼šç”¨æˆ·äº¤äº’ç•Œé¢
â”‚   â”œâ”€â”€ components/                   # UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ analysis_form.py          # åˆ†æè¡¨å•ï¼šç”¨æˆ·è¾“å…¥ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ results_display.py        # ç»“æœå±•ç¤ºï¼šåˆ†æç»“æœå¯è§†åŒ–
â”‚   â”‚   â””â”€â”€ sidebar.py                # ä¾§è¾¹æ ï¼šé…ç½®å’Œå¯¼èˆª
â”‚   â””â”€â”€ utils/                        # Webå·¥å…·
â”‚       â”œâ”€â”€ analysis_runner.py        # åˆ†ææ‰§è¡Œå™¨ï¼šåå°åˆ†æä»»åŠ¡
â”‚       â””â”€â”€ progress_tracker.py       # è¿›åº¦è¿½è¸ªï¼šå®æ—¶è¿›åº¦æ˜¾ç¤º
â”œâ”€â”€ cli/                              # å‘½ä»¤è¡Œç•Œé¢
â”‚   â”œâ”€â”€ main.py                       # CLIä¸»ç¨‹åºï¼šå‘½ä»¤è¡Œå…¥å£
â”‚   â””â”€â”€ utils.py                      # CLIå·¥å…·å‡½æ•°
â”œâ”€â”€ tests/                            # æµ‹è¯•å¥—ä»¶
â”‚   â”œâ”€â”€ integration/                  # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ test_*.py                     # å„ç§æµ‹è¯•ç”¨ä¾‹
â”œâ”€â”€ scripts/                          # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ validation/                   # éªŒè¯è„šæœ¬
â”‚   â”œâ”€â”€ maintenance/                  # ç»´æŠ¤è„šæœ¬
â”‚   â””â”€â”€ setup/                        # å®‰è£…é…ç½®è„šæœ¬
â”œâ”€â”€ docs/                             # æ–‡æ¡£ç›®å½•
â”œâ”€â”€ docker-compose.yml               # Dockerç¼–æ’æ–‡ä»¶
â”œâ”€â”€ pyproject.toml                    # é¡¹ç›®é…ç½®æ–‡ä»¶
â””â”€â”€ requirements.txt                  # ä¾èµ–åˆ—è¡¨ï¼ˆå·²å¼ƒç”¨ï¼Œä½¿ç”¨pyproject.tomlï¼‰
```

---

## 3. æ ¸å¿ƒæŠ€æœ¯æ ˆè§£æ

| æŠ€æœ¯åç§° | åœ¨é¡¹ç›®ä¸­çš„ä½œç”¨ | å­¦ä¹ å»ºè®® |
|---------|---------------|----------|
| **æ¡†æ¶ä¸ç¼–æ’** | | |
| LangGraph | æ ¸å¿ƒç¼–æ’å¼•æ“ï¼Œç®¡ç†å¤šæ™ºèƒ½ä½“å·¥ä½œæµå’ŒçŠ¶æ€è½¬æ¢ | é‡ç‚¹æŒæ¡StateGraphã€èŠ‚ç‚¹å®šä¹‰ã€æ¡ä»¶è¾¹ã€çŠ¶æ€ç®¡ç† |
| LangChain | æä¾›LLMæŠ½è±¡å’Œå·¥å…·é›†æˆï¼Œç®€åŒ–AIåº”ç”¨å¼€å‘ | å­¦ä¹ Agentsæ¦‚å¿µã€Toolä½¿ç”¨ã€Promptç®¡ç† |
| **å‰ç«¯ç•Œé¢** | | |
| Streamlit | Webç•Œé¢æ¡†æ¶ï¼Œæä¾›äº¤äº’å¼åˆ†æç•Œé¢ | æŒæ¡ç»„ä»¶ç³»ç»Ÿã€çŠ¶æ€ç®¡ç†ã€session_state |
| **LLMæä¾›å•†** | | |
| DashScope | é˜¿é‡Œäº‘Qwenæ¨¡å‹æ¥å…¥ï¼Œä¸“ä¸ºä¸­æ–‡ä¼˜åŒ– | äº†è§£APIè°ƒç”¨ã€å·¥å…·è°ƒç”¨ã€æˆæœ¬æ§åˆ¶ |
| DeepSeek | é«˜æ€§ä»·æ¯”ä¸­æ–‡å¤§æ¨¡å‹ï¼Œæ”¯æŒå¤æ‚æ¨ç† | å­¦ä¹ æ¨¡å‹é€‰æ‹©ã€å‚æ•°è°ƒä¼˜ã€å“åº”è§£æ |
| OpenAI | GPTç³»åˆ—æ¨¡å‹ï¼Œæä¾›å¼ºå¤§çš„æ¨ç†èƒ½åŠ› | æŒæ¡APIä½¿ç”¨ã€å·¥å…·è°ƒç”¨ã€ç»“æ„åŒ–è¾“å‡º |
| Google AI | Geminiæ¨¡å‹ï¼Œå¤šæ¨¡æ€èƒ½åŠ›æ”¯æŒ | äº†è§£å¤šæ¨¡æ€å¤„ç†ã€APIé›†æˆ |
| **æ•°æ®æº** | | |
| Tushare | ä¸“ä¸šAè‚¡æ•°æ®æ¥å£ï¼Œæä¾›åŸºæœ¬é¢å’ŒæŠ€æœ¯é¢æ•°æ® | æŒæ¡æ•°æ®å­—æ®µã€APIé™åˆ¶ã€æ•°æ®è´¨é‡ |
| AkShare | å¼€æºé‡‘èæ•°æ®åº“ï¼Œè¦†ç›–å¤šä¸ªå¸‚åœº | å­¦ä¹ æ•°æ®è·å–ã€æ ¼å¼å¤„ç†ã€ç¼“å­˜ç­–ç•¥ |
| FinnHub | å›½é™…è‚¡å¸‚æ•°æ®ï¼Œæ”¯æŒç¾è‚¡å’Œå…¶ä»–å¸‚åœº | äº†è§£APIé…é¢ã€æ•°æ®ç»“æ„ã€å®æ—¶æ•°æ® |
| Yahoo Finance | å…¨çƒè‚¡å¸‚æ•°æ®ï¼Œå…è´¹è·å–åŸºç¡€ä¿¡æ¯ | æŒæ¡yfinanceåº“ã€æ•°æ®å¯é æ€§ã€é™åˆ¶æ¡ä»¶ |
| **å­˜å‚¨ç³»ç»Ÿ** | | |
| MongoDB | æ–‡æ¡£æ•°æ®åº“ï¼Œå­˜å‚¨åˆ†æç»“æœå’Œé…ç½®ä¿¡æ¯ | å­¦ä¹ æ–‡æ¡£ç»“æ„ã€æŸ¥è¯¢è¯­æ³•ã€ç´¢å¼•ä¼˜åŒ– |
| Redis | å†…å­˜ç¼“å­˜ï¼Œæé«˜æ•°æ®è®¿é—®é€Ÿåº¦ | æŒæ¡ç¼“å­˜ç­–ç•¥ã€æ•°æ®ç»“æ„ã€è¿‡æœŸæœºåˆ¶ |
| ChromaDB | å‘é‡æ•°æ®åº“ï¼Œæ”¯æŒè¯­ä¹‰æœç´¢å’Œè®°å¿†åŠŸèƒ½ | äº†è§£å‘é‡å­˜å‚¨ã€ç›¸ä¼¼æ€§æœç´¢ã€åµŒå…¥æ¨¡å‹ |
| **æ•°æ®å¤„ç†** | | |
| pandas | æ•°æ®åˆ†æåº“ï¼Œå¤„ç†é‡‘èæ—¶é—´åºåˆ—æ•°æ® | æŒæ¡DataFrameæ“ä½œã€æ—¶é—´åºåˆ—ã€æ•°æ®æ¸…æ´— |
| stockstats | æŠ€æœ¯æŒ‡æ ‡è®¡ç®—åº“ï¼Œç”ŸæˆæŠ€æœ¯åˆ†ææŒ‡æ ‡ | å­¦ä¹ æŠ€æœ¯æŒ‡æ ‡ã€ä¿¡å·ç”Ÿæˆã€ç­–ç•¥å›æµ‹ |
| **å®¹å™¨åŒ–** | | |
| Docker | å®¹å™¨åŒ–éƒ¨ç½²ï¼Œç®€åŒ–ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²æµç¨‹ | æŒæ¡Dockerfileã€docker-composeã€æœåŠ¡ç¼–æ’ |
| **å¼€å‘å·¥å…·** | | |
| pytest | æµ‹è¯•æ¡†æ¶ï¼Œç¡®ä¿ä»£ç è´¨é‡å’ŒåŠŸèƒ½æ­£ç¡®æ€§ | å­¦ä¹ æµ‹è¯•ç¼–å†™ã€æ¨¡æ‹Ÿå¯¹è±¡ã€é›†æˆæµ‹è¯• |
| rich | ç»ˆç«¯ç¾åŒ–åº“ï¼Œæä¾›ä¸°å¯Œçš„CLIè¾“å‡ºæ ¼å¼ | äº†è§£æ–‡æœ¬æ ¼å¼åŒ–ã€è¿›åº¦æ¡ã€è¡¨æ ¼æ˜¾ç¤º |

---

## 4. å…³é”®ä»£ç æ·±åº¦è§£æ

### 4.1 æ ¸å¿ƒç¼–æ’å¼•æ“ - TradingGraph

ä½ç½®ï¼š`tradingagents/graph/trading_graph.py:40-200`

```python
class TradingAgentsGraph:
    """
    ä¸»è¦ç¼–æ’ç±»ï¼Œè´Ÿè´£åè°ƒæ•´ä¸ªå¤šæ™ºèƒ½ä½“äº¤æ˜“åˆ†ææ¡†æ¶
    
    è®¾è®¡ç†å¿µï¼š
    - é‡‡ç”¨LangGraphä½œä¸ºç¼–æ’å¼•æ“ï¼Œæä¾›çµæ´»çš„å·¥ä½œæµæ§åˆ¶
    - æ”¯æŒå¤šç§LLMæä¾›å•†ï¼Œå®ç°æˆæœ¬å’Œæ€§èƒ½çš„å¹³è¡¡
    - é€šè¿‡é…ç½®ç³»ç»Ÿå®ç°é«˜åº¦å¯å®šåˆ¶åŒ–
    """

    def __init__(
        self,
        selected_analysts=["market", "social", "news", "fundamentals"],  # å¯é€‰æ‹©çš„åˆ†æå¸ˆç±»å‹
        debug=False,  # è°ƒè¯•æ¨¡å¼ï¼Œç”¨äºå¼€å‘å’Œæ•…éšœæ’é™¤
        config: Dict[str, Any] = None,  # é…ç½®å­—å…¸ï¼Œè¦†ç›–é»˜è®¤é…ç½®
    ):
        """
        åˆå§‹åŒ–äº¤æ˜“æ™ºèƒ½ä½“å›¾å’Œç»„ä»¶
        
        å‚æ•°è¯´æ˜ï¼š
        - selected_analysts: é€‰æ‹©è¦å¯ç”¨çš„åˆ†æå¸ˆç±»å‹åˆ—è¡¨
          å¯é€‰å€¼ï¼š["market", "social", "news", "fundamentals", "china_market"]
        - debug: æ˜¯å¦å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼Œå½±å“æ—¥å¿—è¾“å‡ºå’Œé”™è¯¯å¤„ç†
        - config: é…ç½®å­—å…¸ï¼Œå¦‚æœä¸ºNoneåˆ™ä½¿ç”¨é»˜è®¤é…ç½®
        
        åˆå§‹åŒ–æµç¨‹ï¼š
        1. è®¾ç½®åŸºç¡€é…ç½®å’Œè°ƒè¯•æ¨¡å¼
        2. åˆ›å»ºå¿…è¦çš„ç›®å½•ç»“æ„ï¼ˆæ•°æ®ç¼“å­˜ç›®å½•ç­‰ï¼‰
        3. æ ¹æ®é…ç½®åˆå§‹åŒ–ä¸åŒçš„LLMæä¾›å•†
        4. è®¾ç½®æ•°æ®æ¥å£é…ç½®
        """
        self.debug = debug
        self.config = config or DEFAULT_CONFIG  # ä½¿ç”¨ä¼ å…¥é…ç½®æˆ–é»˜è®¤é…ç½®

        # æ›´æ–°æ•°æ®æ¥å£çš„å…¨å±€é…ç½®ï¼Œç¡®ä¿æ‰€æœ‰æ•°æ®æºä½¿ç”¨ç»Ÿä¸€é…ç½®
        set_config(self.config)

        # åˆ›å»ºæ•°æ®ç¼“å­˜ç›®å½•ï¼Œç¡®ä¿ç¼“å­˜ç³»ç»Ÿæ­£å¸¸å·¥ä½œ
        os.makedirs(
            os.path.join(self.config["project_dir"], "dataflows/data_cache"),
            exist_ok=True,
        )

        # åˆå§‹åŒ–LLM - æ ¹æ®é…ç½®é€‰æ‹©ä¸åŒçš„LLMæä¾›å•†
        # è¿™é‡Œçš„è®¾è®¡å…è®¸åŒæ—¶ä½¿ç”¨ä¸åŒçš„æ¨¡å‹ï¼š
        # - deep_thinking_llm: ç”¨äºå¤æ‚æ¨ç†ä»»åŠ¡ï¼ˆå¦‚åŸºæœ¬é¢åˆ†æï¼‰
        # - quick_thinking_llm: ç”¨äºå¿«é€Ÿå“åº”ä»»åŠ¡ï¼ˆå¦‚æƒ…ç»ªåˆ†æï¼‰
        
        if self.config["llm_provider"].lower() == "openai":
            # OpenAIæä¾›å•†ï¼šæ”¯æŒè‡ªå®šä¹‰base_urlï¼Œå¯ç”¨äºOpenAIå…¼å®¹çš„æœåŠ¡
            self.deep_thinking_llm = ChatOpenAI(
                model=self.config["deep_think_llm"], 
                base_url=self.config["backend_url"]
            )
            self.quick_thinking_llm = ChatOpenAI(
                model=self.config["quick_think_llm"], 
                base_url=self.config["backend_url"]
            )
            
        elif self.config["llm_provider"] == "openrouter":
            # OpenRouteræ”¯æŒï¼šç»Ÿä¸€çš„æ¨¡å‹è·¯ç”±æœåŠ¡
            # ä¼˜å…ˆä½¿ç”¨OPENROUTER_API_KEYï¼Œå›é€€åˆ°OPENAI_API_KEY
            openrouter_api_key = os.getenv('OPENROUTER_API_KEY') or os.getenv('OPENAI_API_KEY')
            if not openrouter_api_key:
                raise ValueError("ä½¿ç”¨OpenRouteréœ€è¦è®¾ç½®OPENROUTER_API_KEYæˆ–OPENAI_API_KEYç¯å¢ƒå˜é‡")

            logger.info(f"ğŸŒ [OpenRouter] ä½¿ç”¨APIå¯†é’¥: {openrouter_api_key[:20]}...")
            
            self.deep_thinking_llm = ChatOpenAI(
                model=self.config["deep_think_llm"],
                base_url=self.config["backend_url"],
                api_key=openrouter_api_key
            )
            self.quick_thinking_llm = ChatOpenAI(
                model=self.config["quick_think_llm"],
                base_url=self.config["backend_url"],
                api_key=openrouter_api_key
            )
```

**è®¾è®¡äº®ç‚¹åˆ†æï¼š**

1. **å¤šLLMæä¾›å•†æ”¯æŒ**ï¼šé€šè¿‡ç»Ÿä¸€çš„æ¥å£æ”¯æŒOpenAIã€DashScopeã€DeepSeekç­‰å¤šç§LLMï¼Œå®ç°æˆæœ¬ä¼˜åŒ–å’Œèƒ½åŠ›äº’è¡¥
2. **åˆ†å±‚LLMç­–ç•¥**ï¼šåŒºåˆ†æ·±åº¦æ€è€ƒå’Œå¿«é€Ÿå“åº”æ¨¡å‹ï¼Œé’ˆå¯¹ä¸åŒä»»åŠ¡ç‰¹ç‚¹ä¼˜åŒ–æ€§èƒ½å’Œæˆæœ¬
3. **é…ç½®é©±åŠ¨è®¾è®¡**ï¼šæ‰€æœ‰å…³é”®å‚æ•°éƒ½å¯é€šè¿‡é…ç½®æ–‡ä»¶è°ƒæ•´ï¼Œæ”¯æŒä¸åŒç¯å¢ƒå’Œéœ€æ±‚çš„éƒ¨ç½²

### 4.2 ç»Ÿä¸€æ•°æ®æ¥å£ - Interfaceç³»ç»Ÿ

ä½ç½®ï¼š`tradingagents/dataflows/interface.py:67-120`

```python
def get_finnhub_news(
    ticker: Annotated[
        str,
        "è‚¡ç¥¨ä»£ç ï¼Œä¾‹å¦‚ 'AAPL', 'TSM' ç­‰",  # ä½¿ç”¨ç±»å‹æ³¨è§£æä¾›å‚æ•°è¯´æ˜
    ],
    curr_date: Annotated[str, "å½“å‰æ—¥æœŸï¼Œæ ¼å¼ä¸º yyyy-mm-dd"],
    look_back_days: Annotated[int, "å‘å‰å›æº¯çš„å¤©æ•°"],
):
    """
    æ£€ç´¢æŒ‡å®šæ—¶é—´èŒƒå›´å†…å…¬å¸çš„æ–°é—»ä¿¡æ¯
    
    è®¾è®¡åŸç†ï¼š
    - ç»Ÿä¸€æ–°é—»æ•°æ®è·å–æ¥å£ï¼Œå±è”½ä¸åŒæ•°æ®æºçš„å·®å¼‚
    - æ”¯æŒçµæ´»çš„æ—¶é—´èŒƒå›´æŸ¥è¯¢
    - é›†æˆç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘APIè°ƒç”¨æˆæœ¬
    - æä¾›é™çº§ç­–ç•¥ï¼Œç¡®ä¿æœåŠ¡å¯ç”¨æ€§

    Args:
        ticker (str): ç›®æ ‡å…¬å¸çš„è‚¡ç¥¨ä»£ç 
        curr_date (str): æŸ¥è¯¢çš„åŸºå‡†æ—¥æœŸï¼Œæ ¼å¼ä¸º yyyy-mm-dd
        look_back_days (int): ä»åŸºå‡†æ—¥æœŸå‘å‰å›æº¯çš„å¤©æ•°
        
    Returns:
        str: æ ¼å¼åŒ–çš„æ–°é—»ä¿¡æ¯å­—ç¬¦ä¸²ï¼ŒåŒ…å«æ ‡é¢˜ã€æ‘˜è¦ã€æƒ…ç»ªç­‰
        
    æ•°æ®æµç¨‹ï¼š
    1. å‚æ•°éªŒè¯å’Œæ—¥æœŸè®¡ç®—
    2. æ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨æœ‰æ•ˆæ•°æ®
    3. è°ƒç”¨FinnHub APIè·å–åŸå§‹æ–°é—»æ•°æ®
    4. æ•°æ®æ¸…æ´—å’Œæ ¼å¼åŒ–å¤„ç†
    5. æƒ…ç»ªåˆ†æå’Œé‡è¦æ€§è¯„åˆ†
    6. ç¼“å­˜ç»“æœä»¥å¤‡åç»­ä½¿ç”¨
    """
    try:
        # æ—¥æœŸè®¡ç®—ï¼šç¡®ä¿æŸ¥è¯¢èŒƒå›´çš„å‡†ç¡®æ€§
        # ä½¿ç”¨relativedeltaè€Œä¸æ˜¯timedeltaï¼Œæ›´å¥½åœ°å¤„ç†æœˆä»½è¾¹ç•Œ
        from dateutil.relativedelta import relativedelta
        import pandas as pd
        from datetime import datetime
        
        # å°†å­—ç¬¦ä¸²æ—¥æœŸè½¬æ¢ä¸ºdatetimeå¯¹è±¡ï¼Œä¾¿äºè®¡ç®—
        current_date = datetime.strptime(curr_date, "%Y-%m-%d")
        # è®¡ç®—èµ·å§‹æ—¥æœŸï¼šå½“å‰æ—¥æœŸå‡å»æŒ‡å®šå¤©æ•°
        start_date = current_date - relativedelta(days=look_back_days)
        
        # æ ¼å¼åŒ–æ—¥æœŸä¸ºAPIè¦æ±‚çš„æ ¼å¼
        start_date_str = start_date.strftime("%Y-%m-%d")
        end_date_str = curr_date
        
        logger.info(f"ğŸ“° [æ–°é—»è·å–] è‚¡ç¥¨: {ticker}, æ—¶é—´èŒƒå›´: {start_date_str} åˆ° {end_date_str}")
        
        # è°ƒç”¨åº•å±‚æ–°é—»è·å–å‡½æ•°ï¼Œä¼ å…¥è®¡ç®—å¥½çš„æ—¶é—´å‚æ•°
        # get_data_in_rangeå‡½æ•°è´Ÿè´£å®é™…çš„APIè°ƒç”¨å’Œæ•°æ®å¤„ç†
        news_data = get_data_in_range(
            ticker=ticker,
            start_date=start_date_str,
            end_date=end_date_str,
            data_type="news"  # æŒ‡å®šè·å–æ–°é—»ç±»å‹æ•°æ®
        )
        
        # æ•°æ®éªŒè¯ï¼šæ£€æŸ¥è¿”å›çš„æ•°æ®æ˜¯å¦æœ‰æ•ˆ
        if not news_data or len(news_data) == 0:
            logger.warning(f"âš ï¸ [æ–°é—»è·å–] æœªæ‰¾åˆ° {ticker} åœ¨æŒ‡å®šæ—¶é—´èŒƒå›´å†…çš„æ–°é—»æ•°æ®")
            return f"æœªæ‰¾åˆ° {ticker} åœ¨ {start_date_str} åˆ° {end_date_str} æœŸé—´çš„æ–°é—»ä¿¡æ¯ã€‚"
        
        # æ•°æ®å¤„ç†å’Œæ ¼å¼åŒ–
        # è¿™é‡Œå¯ä»¥æ·»åŠ æ–°é—»å»é‡ã€é‡è¦æ€§æ’åºã€æƒ…ç»ªåˆ†æç­‰å¤„ç†é€»è¾‘
        formatted_news = format_news_data(news_data, ticker)
        
        logger.info(f"âœ… [æ–°é—»è·å–] æˆåŠŸè·å– {len(news_data)} æ¡æ–°é—»")
        return formatted_news
        
    except Exception as e:
        # é”™è¯¯å¤„ç†ï¼šè®°å½•è¯¦ç»†é”™è¯¯ä¿¡æ¯å¹¶æä¾›é™çº§æœåŠ¡
        logger.error(f"âŒ [æ–°é—»è·å–] è·å– {ticker} æ–°é—»æ—¶å‘ç”Ÿé”™è¯¯: {str(e)}")
        logger.error(f"ğŸ“ [é”™è¯¯è¯¦æƒ…] {traceback.format_exc()}")
        
        # è¿”å›é”™è¯¯ä¿¡æ¯è€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼Œä¿è¯ç³»ç»Ÿçš„é²æ£’æ€§
        return f"è·å– {ticker} æ–°é—»ä¿¡æ¯æ—¶å‘ç”Ÿé”™è¯¯: {str(e)}"


def format_news_data(news_data: list, ticker: str) -> str:
    """
    æ ¼å¼åŒ–æ–°é—»æ•°æ®ä¸ºå¯è¯»çš„å­—ç¬¦ä¸²æ ¼å¼
    
    å¤„ç†é€»è¾‘ï¼š
    1. æ–°é—»å»é‡ï¼šåŸºäºæ ‡é¢˜å’Œå‘å¸ƒæ—¶é—´å»é™¤é‡å¤æ–°é—»
    2. é‡è¦æ€§è¯„åˆ†ï¼šæ ¹æ®å…³é”®è¯å’Œæ¥æºè¯„ä¼°æ–°é—»é‡è¦æ€§
    3. æƒ…ç»ªåˆ†æï¼šåˆ†ææ–°é—»æ ‡é¢˜å’Œæ‘˜è¦çš„æƒ…ç»ªå€¾å‘
    4. æ ¼å¼ç»Ÿä¸€ï¼šç”Ÿæˆä¸€è‡´çš„è¾“å‡ºæ ¼å¼
    """
    if not news_data:
        return f"æš‚æ—  {ticker} çš„ç›¸å…³æ–°é—»ã€‚"
    
    formatted_lines = [f"ğŸ“ˆ {ticker} ç›¸å…³æ–°é—»æ±‡æ€»ï¼š\n"]
    
    for i, news_item in enumerate(news_data[:10], 1):  # é™åˆ¶è¿”å›å‰10æ¡æ–°é—»
        # æå–æ–°é—»å…³é”®ä¿¡æ¯
        headline = news_item.get('headline', 'æ— æ ‡é¢˜')
        summary = news_item.get('summary', 'æ— æ‘˜è¦')
        datetime_str = news_item.get('datetime', '')
        source = news_item.get('source', 'æœªçŸ¥æ¥æº')
        
        # æ ¼å¼åŒ–å•æ¡æ–°é—»
        formatted_lines.append(f"{i}. **{headline}**")
        formatted_lines.append(f"   æ¥æº: {source}")
        formatted_lines.append(f"   æ—¶é—´: {datetime_str}")
        formatted_lines.append(f"   æ‘˜è¦: {summary[:200]}...")  # é™åˆ¶æ‘˜è¦é•¿åº¦
        formatted_lines.append("")  # æ·»åŠ ç©ºè¡Œåˆ†éš”
    
    return "\n".join(formatted_lines)
```

**æŠ€æœ¯äº®ç‚¹åˆ†æï¼š**

1. **ç±»å‹æ³¨è§£å¢å¼º**ï¼šä½¿ç”¨`Annotated`ç±»å‹æä¾›è¯¦ç»†çš„å‚æ•°è¯´æ˜ï¼Œæé«˜ä»£ç å¯è¯»æ€§å’ŒIDEæ”¯æŒ
2. **é”™è¯¯å¤„ç†ç­–ç•¥**ï¼šé‡‡ç”¨ä¼˜é›…é™çº§è€Œéå¼‚å¸¸ç»ˆæ­¢ï¼Œç¡®ä¿ç³»ç»Ÿæ•´ä½“ç¨³å®šæ€§
3. **ç¼“å­˜é›†æˆè®¾è®¡**ï¼šè™½ç„¶ä»£ç ä¸­æœªè¯¦ç»†å±•ç¤ºï¼Œä½†æ¥å£è®¾è®¡è€ƒè™‘äº†ç¼“å­˜å±‚çš„é›†æˆ
4. **æ•°æ®æ ‡å‡†åŒ–**ï¼šç»Ÿä¸€ä¸åŒæ•°æ®æºçš„è¾“å‡ºæ ¼å¼ï¼Œç®€åŒ–ä¸Šå±‚ä¸šåŠ¡é€»è¾‘

### 4.3 Webç•Œé¢æ ¸å¿ƒ - Streamlitåº”ç”¨

ä½ç½®ï¼š`web/app.py:38-120`

```python
# è®¾ç½®é¡µé¢é…ç½® - Streamlitåº”ç”¨çš„æ ¸å¿ƒé…ç½®
st.set_page_config(
    page_title="TradingAgents-CN è‚¡ç¥¨åˆ†æå¹³å°",  # æµè§ˆå™¨æ ‡ç­¾é¡µæ ‡é¢˜
    page_icon="ğŸ“ˆ",  # ç½‘ç«™å›¾æ ‡ï¼Œä½¿ç”¨è‚¡ç¥¨ä¸Šæ¶¨emoji
    layout="wide",  # é¡µé¢å¸ƒå±€ï¼šwideæ¨¡å¼å……åˆ†åˆ©ç”¨å±å¹•å®½åº¦
    initial_sidebar_state="expanded",  # ä¾§è¾¹æ åˆå§‹çŠ¶æ€ï¼šå±•å¼€
    menu_items=None  # éšè—Streamlité»˜è®¤èœå•ï¼Œæä¾›æ›´æ¸…æ´çš„ç•Œé¢
)

# è‡ªå®šä¹‰CSSæ ·å¼ - ä¼˜åŒ–ç”¨æˆ·ä½“éªŒçš„å…³é”®è®¾è®¡
st.markdown("""
<style>
    /* 
    éšè—Streamlité»˜è®¤çš„é¡¶éƒ¨å·¥å…·æ å’ŒDeployæŒ‰é’®
    åŸå› ï¼š
    1. æä¾›æ›´ä¸“ä¸šçš„ä¼ä¸šçº§ç•Œé¢ä½“éªŒ
    2. é¿å…ç”¨æˆ·è¯¯æ“ä½œå¯¼è‡´çš„ç•Œé¢æ··ä¹±
    3. ä¸“æ³¨äºæ ¸å¿ƒåŠŸèƒ½ï¼Œå‡å°‘ç•Œé¢å¹²æ‰°
    */
    .stAppToolbar {
        display: none !important;  /* éšè—åº”ç”¨å·¥å…·æ  */
    }
    
    header[data-testid="stHeader"] {
        display: none !important;  /* éšè—é¡µé¢å¤´éƒ¨ */
    }
    
    .stDeployButton {
        display: none !important;  /* éšè—éƒ¨ç½²æŒ‰é’® */
    }
    
    /* å…¼å®¹æ–°ç‰ˆæœ¬Streamlitçš„é€‰æ‹©å™¨ */
    [data-testid="stToolbar"] {
        display: none !important;
    }
    
    [data-testid="stDecoration"] {
        display: none !important;
    }
    
    [data-testid="stStatusWidget"] {
        display: none !important;
    }
    
    /* éšè—æ•´ä¸ªé¡¶éƒ¨åŒºåŸŸï¼Œç¡®ä¿å®Œå…¨çš„å®šåˆ¶åŒ–ç•Œé¢ */
    .stApp > header {
        display: none !important;
    }
    
    /* 
    å®šåˆ¶åŒ–æ ·å¼è®¾è®¡ç†å¿µï¼š
    - ä¸“ä¸šé‡‘èç•Œé¢ï¼šæ·±è‰²ä¸»é¢˜ï¼Œçªå‡ºæ•°æ®å¯è§†åŒ–
    - å“åº”å¼è®¾è®¡ï¼šé€‚é…ä¸åŒå±å¹•å°ºå¯¸
    - ç”¨æˆ·ä½“éªŒä¼˜åŒ–ï¼šå‡å°‘è§†è§‰å™ªéŸ³ï¼Œçªå‡ºæ ¸å¿ƒåŠŸèƒ½
    */
    
    /* ä¸»å®¹å™¨æ ·å¼ */
    .main-container {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 15px;
        padding: 20px;
        margin: 10px 0;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }
    
    /* åˆ†æç»“æœå¡ç‰‡æ ·å¼ */
    .analysis-card {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 12px;
        padding: 20px;
        margin: 15px 0;
        border-left: 4px solid #4CAF50;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    }
    
    /* è¿›åº¦æŒ‡ç¤ºå™¨æ ·å¼ */
    .progress-container {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        padding: 15px;
        margin: 10px 0;
        backdrop-filter: blur(10px);
    }
</style>
""", unsafe_allow_html=True)

def main():
    """
    ä¸»åº”ç”¨ç¨‹åºå…¥å£å‡½æ•°
    
    åº”ç”¨æ¶æ„è®¾è®¡ï¼š
    1. ç»„ä»¶åŒ–è®¾è®¡ï¼šå°†ç•Œé¢æ‹†åˆ†ä¸ºç‹¬ç«‹çš„å¯å¤ç”¨ç»„ä»¶
    2. çŠ¶æ€ç®¡ç†ï¼šä½¿ç”¨Streamlitçš„session_stateç®¡ç†åº”ç”¨çŠ¶æ€
    3. å¼‚æ­¥å¤„ç†ï¼šæ”¯æŒåå°åˆ†æä»»åŠ¡ï¼Œé¿å…ç•Œé¢é˜»å¡
    4. é”™è¯¯å¤„ç†ï¼šæä¾›å‹å¥½çš„é”™è¯¯æç¤ºå’Œæ¢å¤æœºåˆ¶
    """
    
    try:
        # æ¸²æŸ“é¡µé¢å¤´éƒ¨ - åŒ…å«æ ‡é¢˜ã€å¯¼èˆªå’ŒåŸºç¡€ä¿¡æ¯
        render_header()
        
        # æ£€æŸ¥APIå¯†é’¥é…ç½® - ç¡®ä¿ç³»ç»Ÿæ­£å¸¸è¿è¡Œçš„å‰ç½®æ¡ä»¶
        api_status = check_api_keys()
        if not api_status["all_valid"]:
            # å¦‚æœAPIé…ç½®ä¸å®Œæ•´ï¼Œæ˜¾ç¤ºè­¦å‘Šä¿¡æ¯å’Œé…ç½®æŒ‡å¯¼
            st.warning("âš ï¸ æ£€æµ‹åˆ°APIé…ç½®ä¸å®Œæ•´ï¼ŒæŸäº›åŠŸèƒ½å¯èƒ½å—é™ã€‚è¯·æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®ã€‚")
            with st.expander("ğŸ“‹ APIé…ç½®çŠ¶æ€è¯¦æƒ…", expanded=False):
                for service, status in api_status.items():
                    if service != "all_valid":
                        icon = "âœ…" if status else "âŒ"
                        st.write(f"{icon} {service}: {'å·²é…ç½®' if status else 'æœªé…ç½®'}")
        
        # ä½¿ç”¨åˆ—å¸ƒå±€åˆ›å»ºå“åº”å¼ç•Œé¢
        col1, col2 = st.columns([1, 2])  # 1:2çš„æ¯”ä¾‹ï¼Œä¾§è¾¹æ è¾ƒçª„ï¼Œä¸»å†…å®¹åŒºè¾ƒå®½
        
        with col1:
            # æ¸²æŸ“ä¾§è¾¹æ  - åŒ…å«å‚æ•°é…ç½®ã€å†å²è®°å½•ç­‰
            analysis_params = render_sidebar()
        
        with col2:
            # æ¸²æŸ“ä¸»è¦åˆ†æç•Œé¢
            if analysis_params:
                # å‚æ•°éªŒè¯ï¼šç¡®ä¿æ‰€æœ‰å¿…è¦å‚æ•°éƒ½å·²æä¾›
                validation_result = validate_analysis_params(analysis_params)
                
                if validation_result["valid"]:
                    # å‚æ•°æœ‰æ•ˆï¼Œå¼€å§‹åˆ†ææµç¨‹
                    st.success("âœ… å‚æ•°éªŒè¯é€šè¿‡ï¼Œå‡†å¤‡å¼€å§‹åˆ†æ...")
                    
                    # æ˜¾ç¤ºåˆ†æå‚æ•°æ‘˜è¦
                    with st.expander("ğŸ“Š åˆ†æå‚æ•°æ‘˜è¦", expanded=False):
                        st.json(analysis_params)
                    
                    # åˆ›å»ºåˆ†æä»»åŠ¡
                    if st.button("ğŸš€ å¼€å§‹æ™ºèƒ½åˆ†æ", type="primary", use_container_width=True):
                        analyze_stock(analysis_params)
                else:
                    # å‚æ•°éªŒè¯å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                    st.error("âŒ å‚æ•°éªŒè¯å¤±è´¥ï¼š")
                    for error in validation_result["errors"]:
                        st.write(f"â€¢ {error}")
            else:
                # æ˜¾ç¤ºæ¬¢è¿ç•Œé¢å’Œä½¿ç”¨æŒ‡å¯¼
                render_welcome_interface()
    
    except Exception as e:
        # å…¨å±€é”™è¯¯å¤„ç†ï¼šæ•è·æ‰€æœ‰æœªé¢„æœŸçš„é”™è¯¯
        logger.error(f"âŒ [Webç•Œé¢] åº”ç”¨ç¨‹åºå‘ç”Ÿé”™è¯¯: {str(e)}")
        logger.error(f"ğŸ“ [é”™è¯¯è¯¦æƒ…] {traceback.format_exc()}")
        
        st.error("ğŸš¨ åº”ç”¨ç¨‹åºé‡åˆ°äº†ä¸€ä¸ªé”™è¯¯")
        with st.expander("ğŸ” é”™è¯¯è¯¦æƒ…ï¼ˆå¼€å‘è€…ä¿¡æ¯ï¼‰", expanded=False):
            st.code(str(e))
            st.code(traceback.format_exc())


def analyze_stock(params: dict):
    """
    æ‰§è¡Œè‚¡ç¥¨åˆ†æçš„æ ¸å¿ƒå‡½æ•°
    
    åˆ†ææµç¨‹è®¾è®¡ï¼š
    1. å¼‚æ­¥ä»»åŠ¡å¯åŠ¨ï¼šé¿å…ç•Œé¢é˜»å¡
    2. å®æ—¶è¿›åº¦æ˜¾ç¤ºï¼šæä¾›ç”¨æˆ·åé¦ˆ
    3. ç»“æœæµå¼å±•ç¤ºï¼šè¾¹åˆ†æè¾¹å±•ç¤ºç»“æœ
    4. é”™è¯¯æ¢å¤æœºåˆ¶ï¼šåˆ†æå¤±è´¥æ—¶çš„å¤„ç†ç­–ç•¥
    """
    
    # åˆ›å»ºè¿›åº¦è¿½è¸ªå™¨ - ç®¡ç†åˆ†æè¿›å±•çš„å¯è§†åŒ–æ˜¾ç¤º
    progress_tracker = AsyncProgressTracker()
    
    # æ˜¾ç¤ºè¿›åº¦å®¹å™¨
    progress_container = st.container()
    results_container = st.container()
    
    with progress_container:
        st.info("ğŸ”„ æ­£åœ¨å¯åŠ¨å¤šæ™ºèƒ½ä½“åˆ†æç³»ç»Ÿ...")
        
        # åˆ›å»ºè¿›åº¦æ¡å’ŒçŠ¶æ€æ˜¾ç¤º
        progress_bar = st.progress(0)
        status_text = st.empty()
        
        # æ˜¾ç¤ºåˆ†æé˜¶æ®µ
        stages = [
            "ğŸ” æ•°æ®æ”¶é›†ä¸é¢„å¤„ç†",
            "ğŸ“Š å¸‚åœºæŠ€æœ¯åˆ†æ",
            "ğŸ“ˆ åŸºæœ¬é¢åˆ†æ", 
            "ğŸ“° æ–°é—»æƒ…ç»ªåˆ†æ",
            "ğŸ’¬ ç¤¾äº¤åª’ä½“ç›‘æ§",
            "ğŸ¤” å¤šæ–¹ç ”ç©¶è¾©è®º",
            "âš–ï¸ é£é™©è¯„ä¼°åˆ†æ",
            "ğŸ¯ æŠ•èµ„å†³ç­–ç”Ÿæˆ"
        ]
        
        # æ¨¡æ‹Ÿåˆ†æè¿›ç¨‹ï¼ˆå®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šè°ƒç”¨çœŸå®çš„åˆ†æé€»è¾‘ï¼‰
        for i, stage in enumerate(stages):
            # æ›´æ–°è¿›åº¦å’ŒçŠ¶æ€
            progress = (i + 1) / len(stages)
            progress_bar.progress(progress)
            status_text.text(f"{stage} ({int(progress * 100)}%)")
            
            # è¿™é‡Œä¼šè°ƒç”¨å®é™…çš„åˆ†æå‡½æ•°
            # stage_result = run_analysis_stage(stage, params)
            
            # æ¨¡æ‹Ÿå¤„ç†æ—¶é—´
            time.sleep(1)
    
    # æ˜¾ç¤ºåˆ†æç»“æœ
    with results_container:
        st.success("âœ… åˆ†æå®Œæˆï¼")
        render_analysis_results(params)


def render_analysis_results(params: dict):
    """
    æ¸²æŸ“åˆ†æç»“æœçš„ç•Œé¢ç»„ä»¶
    
    ç»“æœå±•ç¤ºè®¾è®¡ç†å¿µï¼š
    1. å±‚æ¬¡åŒ–ä¿¡æ¯æ¶æ„ï¼šä»æ¦‚è¦åˆ°è¯¦æƒ…çš„æ¸è¿›å¼å±•ç¤º
    2. äº¤äº’å¼æ¢ç´¢ï¼šç”¨æˆ·å¯ä»¥æ·±å…¥æŸ¥çœ‹æ„Ÿå…´è¶£çš„éƒ¨åˆ†
    3. å¯è§†åŒ–ä¼˜å…ˆï¼šå›¾è¡¨å’Œæ•°æ®å¹¶é‡
    4. å¯æ“ä½œæ€§ï¼šæä¾›å¯¼å‡ºã€åˆ†äº«ç­‰åŠŸèƒ½
    """
    
    # åˆ†æç»“æœæ¦‚è¦å¡ç‰‡
    st.markdown("""
    <div class="analysis-card">
        <h3>ğŸ“‹ åˆ†æç»“æœæ¦‚è¦</h3>
        <p>åŸºäºå¤šæ™ºèƒ½ä½“åä½œåˆ†æï¼Œä¸ºæ‚¨ç”Ÿæˆä¸“ä¸šçš„æŠ•èµ„å»ºè®®</p>
    </div>
    """, unsafe_allow_html=True)
    
    # ä½¿ç”¨æ ‡ç­¾é¡µç»„ç»‡ä¸åŒç±»å‹çš„åˆ†æç»“æœ
    tab1, tab2, tab3, tab4 = st.tabs(["ğŸ“Š æŠ€æœ¯åˆ†æ", "ğŸ“ˆ åŸºæœ¬é¢åˆ†æ", "ğŸ“° æ–°é—»åˆ†æ", "ğŸ¯ æŠ•èµ„å»ºè®®"])
    
    with tab1:
        st.subheader("æŠ€æœ¯åˆ†æç»“æœ")
        # è¿™é‡Œä¼šæ˜¾ç¤ºæŠ€æœ¯æŒ‡æ ‡ã€å›¾è¡¨ç­‰
        st.info("æŠ€æœ¯åˆ†æç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º...")
        
    with tab2:
        st.subheader("åŸºæœ¬é¢åˆ†æ")
        # æ˜¾ç¤ºè´¢åŠ¡æŒ‡æ ‡ã€ä¼°å€¼åˆ†æç­‰
        st.info("åŸºæœ¬é¢åˆ†æç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º...")
        
    with tab3:
        st.subheader("æ–°é—»æƒ…ç»ªåˆ†æ")
        # æ˜¾ç¤ºæ–°é—»æ‘˜è¦ã€æƒ…ç»ªåˆ†æç­‰
        st.info("æ–°é—»åˆ†æç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º...")
        
    with tab4:
        st.subheader("æœ€ç»ˆæŠ•èµ„å»ºè®®")
        # æ˜¾ç¤ºç»¼åˆå»ºè®®ã€é£é™©æç¤ºç­‰
        st.info("æŠ•èµ„å»ºè®®å°†åœ¨è¿™é‡Œæ˜¾ç¤º...")


if __name__ == "__main__":
    main()
```

**ç•Œé¢è®¾è®¡äº®ç‚¹ï¼š**

1. **ä¸“ä¸šç•Œé¢å®šåˆ¶**ï¼šé€šè¿‡CSSå®Œå…¨éšè—Streamlité»˜è®¤å…ƒç´ ï¼Œåˆ›å»ºä¸“ä¸šçš„é‡‘èåº”ç”¨ç•Œé¢
2. **ç»„ä»¶åŒ–æ¶æ„**ï¼šå°†å¤æ‚ç•Œé¢æ‹†åˆ†ä¸ºç‹¬ç«‹ç»„ä»¶ï¼Œæé«˜ä»£ç å¤ç”¨æ€§å’Œç»´æŠ¤æ€§
3. **å¼‚æ­¥å¤„ç†æ”¯æŒ**ï¼šé€šè¿‡è¿›åº¦è¿½è¸ªå™¨æ”¯æŒé•¿æ—¶é—´è¿è¡Œçš„åˆ†æä»»åŠ¡
4. **å“åº”å¼è®¾è®¡**ï¼šä½¿ç”¨åˆ—å¸ƒå±€å’Œæ ‡ç­¾é¡µé€‚é…ä¸åŒå±å¹•å°ºå¯¸

---

## 5. æœ¬åœ°ç¯å¢ƒè®¾ç½®ä¸å¯åŠ¨æŒ‡å—

### 5.1 ä¾èµ–å®‰è£…

#### ç³»ç»Ÿè¦æ±‚
- Python 3.10+
- Git
- Docker (å¯é€‰ï¼Œç”¨äºå®¹å™¨åŒ–éƒ¨ç½²)
- MongoDB (å¯é€‰ï¼Œç”¨äºæŒä¹…åŒ–å­˜å‚¨)
- Redis (å¯é€‰ï¼Œç”¨äºç¼“å­˜åŠ é€Ÿ)

#### æ ¸å¿ƒä¾èµ–å®‰è£…

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/TradingAgents-CN.git
cd TradingAgents-CN

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
python -m venv venv
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

# 3. å®‰è£…é¡¹ç›®ä¾èµ–ï¼ˆæ¨èæ–¹æ³•ï¼‰
pip install -e .

# æˆ–è€…ä½¿ç”¨uvï¼ˆæ›´å¿«çš„åŒ…ç®¡ç†å™¨ï¼‰
pip install uv
uv pip install -e .

# 4. å¤‡ç”¨å®‰è£…æ–¹æ³•ï¼ˆå¦‚æœä¸Šè¿°æ–¹æ³•å¤±è´¥ï¼‰
pip install -r requirements.txt
```

#### ç¯å¢ƒå˜é‡é…ç½®

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®å¿…è¦çš„APIå¯†é’¥ï¼š

```env
# LLMæä¾›å•†é…ç½®
LLM_PROVIDER=dashscope  # å¯é€‰ï¼šdashscope, openai, deepseek, google
DASHSCOPE_API_KEY=your_dashscope_api_key
OPENAI_API_KEY=your_openai_api_key
DEEPSEEK_API_KEY=your_deepseek_api_key
GOOGLE_API_KEY=your_google_api_key

# æ•°æ®æºé…ç½®
TUSHARE_TOKEN=your_tushare_token
FINNHUB_API_KEY=your_finnhub_api_key

# æ•°æ®åº“é…ç½®ï¼ˆå¯é€‰ï¼‰
MONGODB_URL=mongodb://localhost:27017/
REDIS_URL=redis://localhost:6379/0

# å…¶ä»–é…ç½®
MEMORY_ENABLED=true  # Windows 10ç”¨æˆ·å»ºè®®è®¾ç½®ä¸ºfalse
DEBUG=false
```

### 5.2 å¯åŠ¨æ­¥éª¤

#### æ–¹æ³•ä¸€ï¼šWebç•Œé¢å¯åŠ¨ï¼ˆæ¨èï¼‰

```bash
# ç›´æ¥å¯åŠ¨Webç•Œé¢
python start_web.py

# æˆ–è€…ä½¿ç”¨Streamlitå‘½ä»¤
streamlit run web/app.py

# æˆ–è€…ä½¿ç”¨å†…ç½®è„šæœ¬
python web/run_web.py
```

å¯åŠ¨åè®¿é—®ï¼š`http://localhost:8501`

#### æ–¹æ³•äºŒï¼šå‘½ä»¤è¡Œç•Œé¢

```bash
# äº¤äº’å¼CLI
python -m cli.main

# ç›´æ¥åˆ†æï¼ˆéäº¤äº’æ¨¡å¼ï¼‰
python main.py
```

#### æ–¹æ³•ä¸‰ï¼šDockeréƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d --build

# ä»…å¯åŠ¨ï¼ˆä¸é‡æ–°æ„å»ºï¼‰
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f web

# åœæ­¢æœåŠ¡
docker-compose down
```

Dockeréƒ¨ç½²åŒ…å«çš„æœåŠ¡ï¼š
- Webåº”ç”¨ (ç«¯å£8501)
- MongoDB (ç«¯å£27017)
- Redis (ç«¯å£6379)
- Mongo Express (ç«¯å£8081ï¼Œæ•°æ®åº“ç®¡ç†ç•Œé¢)

#### æ–¹æ³•å››ï¼šæ™ºèƒ½å¯åŠ¨è„šæœ¬

```bash
# Windowsç”¨æˆ·
powershell -ExecutionPolicy Bypass -File scripts\smart_start.ps1

# Linux/Macç”¨æˆ·
./scripts/smart_start.sh
```

æ™ºèƒ½å¯åŠ¨è„šæœ¬ä¼šï¼š
1. è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒå˜åŒ–
2. å†³å®šæ˜¯å¦éœ€è¦é‡æ–°æ„å»ºDockeré•œåƒ
3. å¯åŠ¨æ‰€æœ‰å¿…è¦çš„æœåŠ¡
4. æä¾›å¥åº·æ£€æŸ¥å’Œæ—¥å¿—ç›‘æ§

### 5.3 éªŒè¯å®‰è£…

#### å¿«é€Ÿæµ‹è¯•

```bash
# æµ‹è¯•åŸºç¡€åŠŸèƒ½
python tests/quick_test.py

# æµ‹è¯•æ•°æ®æºè¿æ¥
python scripts/check_api_config.py

# æµ‹è¯•ç³»ç»ŸçŠ¶æ€
python scripts/validation/check_system_status.py
```

#### é›†æˆæµ‹è¯•

```bash
# æµ‹è¯•DashScopeé›†æˆ
python tests/integration/test_dashscope_integration.py

# æµ‹è¯•æ•°æ®æº
python tests/test_data_sources_comprehensive.py

# æµ‹è¯•ç‰¹å®šè‚¡ç¥¨åˆ†æ
python tests/test_601127_final.py  # Aè‚¡æµ‹è¯•
python tests/test_hk_simple.py    # æ¸¯è‚¡æµ‹è¯•
```

### 5.4 å¸¸è§é—®é¢˜è§£å†³

#### 1. Windows 10 ChromaDBå…¼å®¹æ€§é—®é¢˜

```bash
# è®¾ç½®ç¯å¢ƒå˜é‡ç¦ç”¨ChromaDB
echo "MEMORY_ENABLED=false" >> .env

# æˆ–è€…è¿è¡Œä¿®å¤è„šæœ¬
python scripts/fix_chromadb_win10.py
```

#### 2. æ¨¡å—å¯¼å…¥é”™è¯¯

```bash
# ç¡®ä¿æ­£ç¡®å®‰è£…é¡¹ç›®
pip install -e .

# æ£€æŸ¥Pythonè·¯å¾„
python -c "import sys; print(sys.path)"
```

#### 3. APIé…é¢é™åˆ¶

```bash
# é…ç½®æ•°æ®ç›®å½•ç¼“å­˜
python examples/data_dir_config_demo.py

# ä½¿ç”¨ç¼“å­˜æ¸…ç†è„šæœ¬
python scripts/maintenance/cleanup_cache.py --days 7
```

#### 4. ç«¯å£å†²çª

```bash
# ä¿®æ”¹docker-compose.ymlä¸­çš„ç«¯å£æ˜ å°„
# æˆ–è€…åœæ­¢å ç”¨ç«¯å£çš„æœåŠ¡
docker-compose down
```

### 5.5 é«˜çº§é…ç½®

#### è‡ªå®šä¹‰é…ç½®æ–‡ä»¶

```python
# åˆ›å»ºè‡ªå®šä¹‰é…ç½®
from tradingagents.default_config import DEFAULT_CONFIG

custom_config = DEFAULT_CONFIG.copy()
custom_config.update({
    "llm_provider": "deepseek",
    "research_depth": 3,
    "max_debate_rounds": 2,
    "use_cache": True
})

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®å¯åŠ¨
from tradingagents.graph.trading_graph import TradingAgentsGraph
graph = TradingAgentsGraph(config=custom_config)
```

#### æ•°æ®åº“åˆå§‹åŒ–

```bash
# åˆå§‹åŒ–MongoDBæ•°æ®åº“
python scripts/setup/init_database.py

# åŒæ­¥è‚¡ç¥¨ä¿¡æ¯åˆ°æ•°æ®åº“
python data/scripts/sync_stock_info_to_mongodb.py
```

#### æ€§èƒ½ä¼˜åŒ–é…ç½®

```bash
# é…ç½®Redisç¼“å­˜
python scripts/setup/setup_databases.py

# ä¼˜åŒ–æ•°æ®æºé…ç½®
python scripts/validation/smart_config.py
```

è¿™æ ·ï¼Œæ‚¨å°±å®Œæˆäº†TradingAgents-CNé¡¹ç›®çš„æœ¬åœ°ç¯å¢ƒæ­å»ºã€‚å»ºè®®å…ˆä»Webç•Œé¢å¼€å§‹ä½“éªŒï¼Œç„¶åæ ¹æ®éœ€è¦æ·±å…¥äº†è§£CLIå’ŒAPIä½¿ç”¨æ–¹å¼ã€‚